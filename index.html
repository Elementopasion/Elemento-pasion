<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moda Elegante - Tienda de Ropa Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Todos los estilos CSS anteriores SE MANTIENEN IGUAL */
        /* Copia TODO el CSS desde el código anterior */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            color: #333;
            line-height: 1.6;
            background-color: #f9f9f9;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* ... COPIA TODOS LOS ESTILOS DEL CÓDIGO ANTERIOR ... */
        /* No los copio todos aquí por espacio, pero DEBES COPIARLOS */
        
    </style>
</head>
<body>
    <!-- Header y navegación (IGUAL QUE ANTES) -->
    <header>
        <div class="container header-container">
            <a href="index.html" class="logo">Moda<span>Elegante</span></a>
            
            <div class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </div>
            
            <nav>
                <ul id="navMenu">
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="categoria-hombre.html">Hombre</a></li>
                    <li><a href="categoria-mujer.html">Mujer</a></li>
                    <li><a href="categoria-accesorios.html">Accesorios</a></li>
                    <li><a href="categoria-ninos.html">Niños</a></li>
                    <li><a href="categoria-calzado.html">Calzado</a></li>
                    <li>
                        <a href="#" class="cart-icon" id="openCart">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="cart-count" id="cartCount">0</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="inicio">
        <div class="container">
            <h1>Descubre la nueva colección de otoño</h1>
            <p>Ropa de alta calidad con los mejores diseños para hombres y mujeres. Encuentra tu estilo único con nuestras prendas exclusivas.</p>
            <a href="#productos" class="btn">Ver Colección</a>
        </div>
    </section>

    <!-- Categorías -->
    <section class="categories" id="categorias">
        <div class="container">
            <h2 class="section-title">Nuestras Categorías</h2>
            <div class="categories-grid">
                <a href="categoria-hombre.html" class="category-card">
                    <div class="category-img" style="background-image: url('https://images.unsplash.com/photo-1520975916090-3105956dac38?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80');"></div>
                    <div class="category-content">
                        <h3>Ropa de Hombre</h3>
                        <p>Camisas, jeans, chaquetas y accesorios para el hombre contemporáneo.</p>
                    </div>
                </a>
                
                <a href="categoria-mujer.html" class="category-card">
                    <div class="category-img" style="background-image: url('https://images.unsplash.com/photo-1496747611176-843222e1e57c?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80');"></div>
                    <div class="category-content">
                        <h3>Ropa de Mujer</h3>
                        <p>Vestidos, blusas, pantalones y más para el estilo femenino moderno.</p>
                    </div>
                </a>
                
                <a href="categoria-accesorios.html" class="category-card">
                    <div class="category-img" style="background-image: url('https://images.unsplash.com/photo-1558769132-cb1a40ed0ada?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80');"></div>
                    <div class="category-content">
                        <h3>Accesorios</h3>
                        <p>Bolsos, gorras, gafas y complementos para completar tu look.</p>
                    </div>
                </a>
                
                <a href="categoria-ninos.html" class="category-card">
                    <div class="category-img" style="background-image: url('https://images.unsplash.com/photo-1539109136881-3be0616acf4b?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80');"></div>
                    <div class="category-content">
                        <h3>Ropa de Niños</h3>
                        <p>Ropa cómoda y divertida para los más pequeños de la casa.</p>
                    </div>
                </a>
                
                <a href="categoria-calzado.html" class="category-card">
                    <div class="category-img" style="background-image: url('https://images.unsplash.com/photo-1549298916-b41d501d3772?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80');"></div>
                    <div class="category-content">
                        <h3>Calzado</h3>
                        <p>Zapatos para todas las ocasiones, desde deportivos hasta formales.</p>
                    </div>
                </a>
                
                <a href="categoria-ofertas.html" class="category-card">
                    <div class="category-img" style="background-image: url('https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80');"></div>
                    <div class="category-content">
                        <h3>Ofertas Especiales</h3>
                        <p>Las mejores promociones y descuentos en productos seleccionados.</p>
                    </div>
                </a>
            </div>
        </div>
    </section>

    <!-- Productos destacados -->
    <section class="featured-products" id="productos">
        <div class="container">
            <h2 class="section-title">Productos Destacados</h2>
            <div class="products-grid" id="featuredProducts">
                <!-- Los productos se cargarán dinámicamente desde Google Sheets -->
                <div class="loading-products" style="text-align: center; padding: 40px; grid-column: 1 / -1;">
                    <div class="spinner" style="border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
                    <p>Cargando productos...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contacto">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-column">
                    <h3>Moda Elegante</h3>
                    <p>Tu tienda de ropa online con las últimas tendencias en moda para toda la familia. Calidad, estilo y comodidad en un solo lugar.</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-pinterest"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Categorías</h3>
                    <ul>
                        <li><a href="categoria-hombre.html">Ropa de Hombre</a></li>
                        <li><a href="categoria-mujer.html">Ropa de Mujer</a></li>
                        <li><a href="categoria-ninos.html">Ropa de Niños</a></li>
                        <li><a href="categoria-accesorios.html">Accesorios</a></li>
                        <li><a href="categoria-calzado.html">Calzado</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Información</h3>
                    <ul>
                        <li><a href="#">Sobre Nosotros</a></li>
                        <li><a href="#">Política de Envíos</a></li>
                        <li><a href="#">Términos y Condiciones</a></li>
                        <li><a href="#">Política de Privacidad</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Contacto</h3>
                    <ul>
                        <li><i class="fas fa-map-marker-alt"></i> Calle Moda 123, Ciudad</li>
                        <li><i class="fas fa-phone"></i> +1 234 567 890</li>
                        <li><i class="fas fa-envelope"></i> info@modaelegante.com</li>
                        <li><i class="fab fa-whatsapp"></i> +54 9 11 1234-5678</li>
                    </ul>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 Moda Elegante. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Todos los modales (carrito, checkout, instrucciones) SE MANTIENEN -->
    <!-- Copia los modales del código anterior -->

    <script>
        // ============================================
        // CONFIGURACIÓN DE LA API
        // ============================================
        
        // ¡¡¡IMPORTANTE!!! Cambia esta URL por la de TU Google Apps Script
        const API_URL = 'https://script.google.com/macros/s/AKfycbwV5lB9P7O7p5n8Q2q3Q4W5R6X7Y8Z9a0b1c2d3e4f5g6h7i8j9k0l1m2n3o4p5/exec';
        
        // ============================================
        // SISTEMA DE PRODUCTOS CON GOOGLE SHEETS
        // ============================================
        
        class ProductManager {
            constructor() {
                this.products = [];
                this.init();
            }
            
            async init() {
                await this.loadProductsFromAPI();
                this.displayFeaturedProducts();
                this.setupCartButtons();
            }
            
            async loadProductsFromAPI() {
                try {
                    const loadingElement = document.querySelector('.loading-products');
                    if (loadingElement) {
                        loadingElement.innerHTML = '<p>Cargando productos desde la nube...</p>';
                    }
                    
                    const response = await fetch(`${API_URL}?action=getProducts`);
                    const products = await response.json();
                    
                    // Convertir strings a tipos correctos
                    this.products = products.map(product => ({
                        ...product,
                        id: Number(product.id),
                        price: Number(product.price),
                        featured: product.featured === 'true' || product.featured === true
                    }));
                    
                    // Guardar en cache local también
                    localStorage.setItem('modaEleganteProducts', JSON.stringify(this.products));
                    
                } catch (error) {
                    console.error('Error cargando productos:', error);
                    // Intentar cargar del cache local
                    this.products = JSON.parse(localStorage.getItem('modaEleganteProducts')) || [];
                    
                    const featuredProducts = document.getElementById('featuredProducts');
                    if (featuredProducts) {
                        featuredProducts.innerHTML += `
                            <div style="grid-column: 1 / -1; text-align: center; padding: 20px; color: #e74c3c;">
                                <p>⚠️ No se pudo conectar con el servidor. Mostrando productos en cache.</p>
                            </div>
                        `;
                    }
                }
            }
            
            async addProductToAPI(productData) {
                try {
                    const params = new URLSearchParams({
                        action: 'addProduct',
                        ...productData
                    });
                    
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        body: params
                    });
                    
                    const result = await response.json();
                    return result.success;
                } catch (error) {
                    console.error('Error agregando producto:', error);
                    return false;
                }
            }
            
            async updateProductInAPI(productId, productData) {
                try {
                    const params = new URLSearchParams({
                        action: 'updateProduct',
                        id: productId,
                        ...productData
                    });
                    
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        body: params
                    });
                    
                    const result = await response.json();
                    return result.success;
                } catch (error) {
                    console.error('Error actualizando producto:', error);
                    return false;
                }
            }
            
            async deleteProductFromAPI(productId) {
                try {
                    const response = await fetch(`${API_URL}?action=deleteProduct&id=${productId}`);
                    const result = await response.json();
                    return result.success;
                } catch (error) {
                    console.error('Error eliminando producto:', error);
                    return false;
                }
            }
            
            displayFeaturedProducts() {
                const container = document.getElementById('featuredProducts');
                if (!container) return;
                
                const featured = this.products.filter(p => p.featured).slice(0, 6);
                
                if (featured.length === 0) {
                    container.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px;">
                            <h3 style="color: #666; margin-bottom: 20px;">No hay productos destacados</h3>
                            <p>Agrega productos y márcalos como "destacados" para que aparezcan aquí.</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = featured.map(product => `
                    <div class="product-card" data-id="${product.id}">
                        <div class="product-img" style="background-image: url('${product.image}')"></div>
                        <div class="product-content">
                            <h3 class="product-title">${product.name}</h3>
                            <div class="product-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <p class="product-price">$${parseFloat(product.price).toFixed(2)}</p>
                            <button class="add-to-cart">Añadir al Carrito</button>
                        </div>
                    </div>
                `).join('');
            }
            
            getProductsByCategory(category) {
                return this.products.filter(product => product.category === category);
            }
            
            setupCartButtons() {
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('add-to-cart') || 
                        e.target.closest('.add-to-cart')) {
                        const productCard = e.target.closest('.product-card');
                        const productId = parseInt(productCard.dataset.id);
                        const product = this.products.find(p => p.id === productId);
                        
                        if (product && window.shoppingCart) {
                            window.shoppingCart.addProduct(product);
                        }
                    }
                });
            }
        }

        // ============================================
        // SISTEMA DE CARRITO DE COMPRAS (IGUAL QUE ANTES)
        // ============================================
        
        class ShoppingCart {
            constructor() {
                this.cart = JSON.parse(localStorage.getItem('modaEleganteCart')) || [];
                this.whatsappNumber = "5491112345678"; // <-- ¡CAMBIA ESTO!
                this.init();
            }
            
            init() {
                this.updateCartCount();
                this.setupEventListeners();
            }
            
            setupEventListeners() {
                // ... (todo el código del carrito SE MANTIENE IGUAL)
                // Copia TODO el código de ShoppingCart del archivo anterior
            }
            
            addProduct(product) {
                // ... (mismo código de antes)
            }
            
            // ... (todas las otras funciones del carrito)
        }

        // ============================================
        // INICIALIZACIÓN
        // ============================================
        
        document.addEventListener('DOMContentLoaded', async () => {
            // Inicializar gestor de productos
            window.productManager = new ProductManager();
            
            // Inicializar carrito
            window.shoppingCart = new ShoppingCart();
            
            // Menú responsive
            const menuToggle = document.getElementById('menuToggle');
            const navMenu = document.getElementById('navMenu');
            
            if (menuToggle && navMenu) {
                menuToggle.addEventListener('click', () => {
                    navMenu.classList.toggle('active');
                });
                
                document.querySelectorAll('nav a').forEach(link => {
                    link.addEventListener('click', () => {
                        navMenu.classList.remove('active');
                    });
                });
            }
            
            // Animación suave para enlaces
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        e.preventDefault();
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // Actualizar productos cada 30 segundos
            setInterval(async () => {
                if (window.productManager) {
                    await window.productManager.loadProductsFromAPI();
                    window.productManager.displayFeaturedProducts();
                }
            }, 30000);
        });
        
        // Animación para el spinner
        const style = document.createElement('style');
        style.textContent = `
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
